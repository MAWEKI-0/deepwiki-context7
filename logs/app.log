{"text": "2025-09-03 03:44:00.005 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n\n", "record": {"elapsed": {"repr": "0:00:21.123875", "seconds": 21.123875}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n", "module": "main", "name": "src.main", "process": {"id": 47088, "name": "SpawnProcess-1"}, "thread": {"id": 51736, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:44:00.005757+02:00", "timestamp": 1756863840.005757}}}
{"text": "2025-09-03 03:44:15.553 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n\n", "record": {"elapsed": {"repr": "0:00:36.671155", "seconds": 36.671155}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n", "module": "main", "name": "src.main", "process": {"id": 47088, "name": "SpawnProcess-1"}, "thread": {"id": 51736, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:44:15.553037+02:00", "timestamp": 1756863855.553037}}}
{"text": "2025-09-03 03:44:31.125 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n\n", "record": {"elapsed": {"repr": "0:00:52.243736", "seconds": 52.243736}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n", "module": "main", "name": "src.main", "process": {"id": 47088, "name": "SpawnProcess-1"}, "thread": {"id": 51736, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:44:31.125618+02:00", "timestamp": 1756863871.125618}}}
{"text": "2025-09-03 03:44:46.804 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n\n", "record": {"elapsed": {"repr": "0:01:07.922798", "seconds": 67.922798}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n", "module": "main", "name": "src.main", "process": {"id": 47088, "name": "SpawnProcess-1"}, "thread": {"id": 51736, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:44:46.804680+02:00", "timestamp": 1756863886.80468}}}
{"text": "2025-09-03 03:45:02.335 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n\n", "record": {"elapsed": {"repr": "0:01:23.453625", "seconds": 83.453625}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n", "module": "main", "name": "src.main", "process": {"id": 47088, "name": "SpawnProcess-1"}, "thread": {"id": 51736, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:45:02.335507+02:00", "timestamp": 1756863902.335507}}}
{"text": "2025-09-03 03:45:35.840 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:01:56.958896", "seconds": 116.958896}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 47088, "name": "SpawnProcess-1"}, "thread": {"id": 51736, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:45:35.840778+02:00", "timestamp": 1756863935.840778}}}
{"text": "2025-09-03 03:46:00.120 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\n", "record": {"elapsed": {"repr": "0:00:20.642176", "seconds": 20.642176}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n", "module": "main", "name": "src.main", "process": {"id": 50488, "name": "SpawnProcess-2"}, "thread": {"id": 52932, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:46:00.120961+02:00", "timestamp": 1756863960.120961}}}
{"text": "2025-09-03 03:46:15.569 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\n", "record": {"elapsed": {"repr": "0:00:36.090892", "seconds": 36.090892}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n", "module": "main", "name": "src.main", "process": {"id": 50488, "name": "SpawnProcess-2"}, "thread": {"id": 52932, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:46:15.569677+02:00", "timestamp": 1756863975.569677}}}
{"text": "2025-09-03 03:46:31.106 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\n", "record": {"elapsed": {"repr": "0:00:51.627296", "seconds": 51.627296}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n", "module": "main", "name": "src.main", "process": {"id": 50488, "name": "SpawnProcess-2"}, "thread": {"id": 52932, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:46:31.106081+02:00", "timestamp": 1756863991.106081}}}
{"text": "2025-09-03 03:46:46.563 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\n", "record": {"elapsed": {"repr": "0:01:07.085004", "seconds": 67.085004}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n", "module": "main", "name": "src.main", "process": {"id": 50488, "name": "SpawnProcess-2"}, "thread": {"id": 52932, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:46:46.563789+02:00", "timestamp": 1756864006.563789}}}
{"text": "2025-09-03 03:47:02.040 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\n", "record": {"elapsed": {"repr": "0:01:22.561720", "seconds": 82.56172}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 214, in _retry_error_helper\n    raise final_exc from source_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.InvalidArgument: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: 400 * BatchEmbedContentsRequest.model: unexpected model name format\n* BatchEmbedContentsRequest.requests[0].model: unexpected model name format\n\n", "module": "main", "name": "src.main", "process": {"id": 50488, "name": "SpawnProcess-2"}, "thread": {"id": 52932, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:47:02.040505+02:00", "timestamp": 1756864022.040505}}}
{"text": "2025-09-03 03:47:24.733 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:01:45.255083", "seconds": 105.255083}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 50488, "name": "SpawnProcess-2"}, "thread": {"id": 52932, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:47:24.733868+02:00", "timestamp": 1756864044.733868}}}
{"text": "2025-09-03 03:47:52.674 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'SingleAPIResponse[TypeVar]' object has no attribute 'error'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 105, in _aretrieve\n    f\"Failed to retrieve ads from Supabase: {response.error}\"\n                                             ^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\pydantic\\main.py\", line 991, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\nAttributeError: 'SingleAPIResponse[TypeVar]' object has no attribute 'error'\n\n", "record": {"elapsed": {"repr": "0:00:22.245730", "seconds": 22.24573}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'SingleAPIResponse[TypeVar]' object has no attribute 'error'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 105, in _aretrieve\n    f\"Failed to retrieve ads from Supabase: {response.error}\"\n                                             ^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\pydantic\\main.py\", line 991, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\nAttributeError: 'SingleAPIResponse[TypeVar]' object has no attribute 'error'\n", "module": "main", "name": "src.main", "process": {"id": 52468, "name": "SpawnProcess-3"}, "thread": {"id": 53184, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:47:52.674803+02:00", "timestamp": 1756864072.674803}}}
{"text": "2025-09-03 03:48:26.199 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:00:55.770365", "seconds": 55.770365}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 52468, "name": "SpawnProcess-3"}, "thread": {"id": 53184, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:48:26.199438+02:00", "timestamp": 1756864106.199438}}}
{"text": "2025-09-03 03:48:49.977 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:18.079359", "seconds": 18.079359}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52924, "name": "SpawnProcess-4"}, "thread": {"id": 46400, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:48:49.977405+02:00", "timestamp": 1756864129.977405}}}
{"text": "2025-09-03 03:49:05.674 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:33.776077", "seconds": 33.776077}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52924, "name": "SpawnProcess-4"}, "thread": {"id": 46400, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:49:05.674123+02:00", "timestamp": 1756864145.674123}}}
{"text": "2025-09-03 03:49:21.394 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:49.496320", "seconds": 49.49632}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52924, "name": "SpawnProcess-4"}, "thread": {"id": 46400, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:49:21.394366+02:00", "timestamp": 1756864161.394366}}}
{"text": "2025-09-03 03:49:37.117 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:05.219179", "seconds": 65.219179}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52924, "name": "SpawnProcess-4"}, "thread": {"id": 46400, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:49:37.117225+02:00", "timestamp": 1756864177.117225}}}
{"text": "2025-09-03 03:49:52.842 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:20.944338", "seconds": 80.944338}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52924, "name": "SpawnProcess-4"}, "thread": {"id": 46400, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:49:52.842384+02:00", "timestamp": 1756864192.842384}}}
{"text": "2025-09-03 03:51:14.569 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:02:42.671811", "seconds": 162.671811}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 52924, "name": "SpawnProcess-4"}, "thread": {"id": 46400, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:51:14.569857+02:00", "timestamp": 1756864274.569857}}}
{"text": "2025-09-03 03:51:36.674 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: {'message': 'invalid input syntax for type uuid: \"1403518777546500\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"1403518777546500\"', 'code': '22P02', 'hint': None, 'details': None}\n\n", "record": {"elapsed": {"repr": "0:00:16.452570", "seconds": 16.45257}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: {'message': 'invalid input syntax for type uuid: \"1403518777546500\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"1403518777546500\"', 'code': '22P02', 'hint': None, 'details': None}\n", "module": "main", "name": "src.main", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:51:36.674895+02:00", "timestamp": 1756864296.674895}}}
{"text": "2025-09-03 03:51:37.521 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:17.299088", "seconds": 17.299088}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:51:37.521413+02:00", "timestamp": 1756864297.521413}}}
{"text": "2025-09-03 03:51:52.916 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: {'message': 'invalid input syntax for type uuid: \"1297420401724984\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"1297420401724984\"', 'code': '22P02', 'hint': None, 'details': None}\n\n", "record": {"elapsed": {"repr": "0:00:32.694522", "seconds": 32.694522}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: {'message': 'invalid input syntax for type uuid: \"1297420401724984\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"1297420401724984\"', 'code': '22P02', 'hint': None, 'details': None}\n", "module": "main", "name": "src.main", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:51:52.916847+02:00", "timestamp": 1756864312.916847}}}
{"text": "2025-09-03 03:51:53.236 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:33.014474", "seconds": 33.014474}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:51:53.236799+02:00", "timestamp": 1756864313.236799}}}
{"text": "2025-09-03 03:52:08.631 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: {'message': 'invalid input syntax for type uuid: \"724504750371814\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"724504750371814\"', 'code': '22P02', 'hint': None, 'details': None}\n\n", "record": {"elapsed": {"repr": "0:00:48.408870", "seconds": 48.40887}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: {'message': 'invalid input syntax for type uuid: \"724504750371814\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"724504750371814\"', 'code': '22P02', 'hint': None, 'details': None}\n", "module": "main", "name": "src.main", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:52:08.631195+02:00", "timestamp": 1756864328.631195}}}
{"text": "2025-09-03 03:52:08.962 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:48.740435", "seconds": 48.740435}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:52:08.962760+02:00", "timestamp": 1756864328.96276}}}
{"text": "2025-09-03 03:52:24.376 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: {'message': 'invalid input syntax for type uuid: \"674954705553504\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"674954705553504\"', 'code': '22P02', 'hint': None, 'details': None}\n\n", "record": {"elapsed": {"repr": "0:01:04.154175", "seconds": 64.154175}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: {'message': 'invalid input syntax for type uuid: \"674954705553504\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"674954705553504\"', 'code': '22P02', 'hint': None, 'details': None}\n", "module": "main", "name": "src.main", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:52:24.376500+02:00", "timestamp": 1756864344.3765}}}
{"text": "2025-09-03 03:52:24.705 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:04.483021", "seconds": 64.483021}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:52:24.705346+02:00", "timestamp": 1756864344.705346}}}
{"text": "2025-09-03 03:52:40.119 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: {'message': 'invalid input syntax for type uuid: \"712981508378395\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"712981508378395\"', 'code': '22P02', 'hint': None, 'details': None}\n\n", "record": {"elapsed": {"repr": "0:01:19.897322", "seconds": 79.897322}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: {'message': 'invalid input syntax for type uuid: \"712981508378395\"', 'code': '22P02', 'hint': None, 'details': None}\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 78, in execute\n    raise APIError(dict(json_obj))\npostgrest.exceptions.APIError: {'message': 'invalid input syntax for type uuid: \"712981508378395\"', 'code': '22P02', 'hint': None, 'details': None}\n", "module": "main", "name": "src.main", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:52:40.119647+02:00", "timestamp": 1756864360.119647}}}
{"text": "2025-09-03 03:52:40.453 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:20.231492", "seconds": 80.231492}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:52:40.453817+02:00", "timestamp": 1756864360.453817}}}
{"text": "2025-09-03 03:52:52.206 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:01:31.984537", "seconds": 91.984537}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 52276, "name": "SpawnProcess-5"}, "thread": {"id": 53360, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:52:52.206862+02:00", "timestamp": 1756864372.206862}}}
{"text": "2025-09-03 03:53:15.673 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:17.876339", "seconds": 17.876339}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 41884, "name": "SpawnProcess-6"}, "thread": {"id": 53800, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:53:15.673992+02:00", "timestamp": 1756864395.673992}}}
{"text": "2025-09-03 03:53:31.397 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:33.599379", "seconds": 33.599379}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 41884, "name": "SpawnProcess-6"}, "thread": {"id": 53800, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:53:31.397032+02:00", "timestamp": 1756864411.397032}}}
{"text": "2025-09-03 03:53:42.644 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:00:44.846603", "seconds": 44.846603}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 41884, "name": "SpawnProcess-6"}, "thread": {"id": 53800, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:53:42.644256+02:00", "timestamp": 1756864422.644256}}}
{"text": "2025-09-03 03:54:42.396 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:00:54.012340", "seconds": 54.01234}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 54224, "name": "SpawnProcess-7"}, "thread": {"id": 55248, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:54:42.396076+02:00", "timestamp": 1756864482.396076}}}
{"text": "2025-09-03 03:55:55.818 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:21.650528", "seconds": 21.650528}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 54548, "name": "SpawnProcess-1"}, "thread": {"id": 47508, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:55:55.818748+02:00", "timestamp": 1756864555.818748}}}
{"text": "2025-09-03 03:56:11.706 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:37.538270", "seconds": 37.53827}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 54548, "name": "SpawnProcess-1"}, "thread": {"id": 47508, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:56:11.706490+02:00", "timestamp": 1756864571.70649}}}
{"text": "2025-09-03 03:56:27.456 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:53.288072", "seconds": 53.288072}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 54548, "name": "SpawnProcess-1"}, "thread": {"id": 47508, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:56:27.456292+02:00", "timestamp": 1756864587.456292}}}
{"text": "2025-09-03 03:56:43.207 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:09.039525", "seconds": 69.039525}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 54548, "name": "SpawnProcess-1"}, "thread": {"id": 47508, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:56:43.207745+02:00", "timestamp": 1756864603.207745}}}
{"text": "2025-09-03 03:56:58.961 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:24.793111", "seconds": 84.793111}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 54548, "name": "SpawnProcess-1"}, "thread": {"id": 47508, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:56:58.961331+02:00", "timestamp": 1756864618.961331}}}
{"text": "2025-09-03 03:57:10.294 | INFO     | src.main:shutdown_event:120 - Shutting down logger.\n", "record": {"elapsed": {"repr": "0:01:36.126256", "seconds": 96.126256}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "shutdown_event", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 120, "message": "Shutting down logger.", "module": "main", "name": "src.main", "process": {"id": 54548, "name": "SpawnProcess-1"}, "thread": {"id": 47508, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:57:10.294476+02:00", "timestamp": 1756864630.294476}}}
{"text": "2025-09-03 03:58:53.992 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 250, in handle_request\n    resp = self._pool.handle_request(req)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection_pool.py\", line 256, in handle_request\n    raise exc from None\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection_pool.py\", line 236, in handle_request\n    response = connection.handle_request(\n        pool_request.request\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection.py\", line 101, in handle_request\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection.py\", line 78, in handle_request\n    stream = self._connect(request)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection.py\", line 124, in _connect\n    stream = self._network_backend.connect_tcp(**kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_backends\\sync.py\", line 207, in connect_tcp\n    with map_exceptions(exc_map):\n         ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectTimeout: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 57, in execute\n    r = self.session.request(\n        self.http_method,\n    ...<3 lines>...\n        headers=self.headers,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 825, in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 914, in send\n    response = self._send_handling_auth(\n        request,\n    ...<2 lines>...\n        history=[],\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 942, in _send_handling_auth\n    response = self._send_handling_redirects(\n        request,\n        follow_redirects=follow_redirects,\n        history=history,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 979, in _send_handling_redirects\n    response = self._send_single_request(request)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 1014, in _send_single_request\n    response = transport.handle_request(request)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 249, in handle_request\n    with map_httpcore_exceptions():\n         ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectTimeout: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\n\n", "record": {"elapsed": {"repr": "0:01:38.045174", "seconds": 98.045174}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 250, in handle_request\n    resp = self._pool.handle_request(req)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection_pool.py\", line 256, in handle_request\n    raise exc from None\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection_pool.py\", line 236, in handle_request\n    response = connection.handle_request(\n        pool_request.request\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection.py\", line 101, in handle_request\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection.py\", line 78, in handle_request\n    stream = self._connect(request)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_sync\\connection.py\", line 124, in _connect\n    stream = self._network_backend.connect_tcp(**kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_backends\\sync.py\", line 207, in connect_tcp\n    with map_exceptions(exc_map):\n         ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectTimeout: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 106, in get_ad_status\n    response = supabase.from_(\"ads\").select(\"status, error_log\").eq(\"id\", ad_id).execute()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\postgrest\\_sync\\request_builder.py\", line 57, in execute\n    r = self.session.request(\n        self.http_method,\n    ...<3 lines>...\n        headers=self.headers,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 825, in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 914, in send\n    response = self._send_handling_auth(\n        request,\n    ...<2 lines>...\n        history=[],\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 942, in _send_handling_auth\n    response = self._send_handling_redirects(\n        request,\n        follow_redirects=follow_redirects,\n        history=history,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 979, in _send_handling_redirects\n    response = self._send_single_request(request)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_client.py\", line 1014, in _send_single_request\n    response = transport.handle_request(request)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 249, in handle_request\n    with map_httpcore_exceptions():\n         ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectTimeout: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\n", "module": "main", "name": "src.main", "process": {"id": 52720, "name": "SpawnProcess-2"}, "thread": {"id": 50204, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:58:53.992353+02:00", "timestamp": 1756864733.992353}}}
{"text": "2025-09-03 03:59:53.458 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: Error embedding content: Timeout of 60.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable\n    return callable_(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_interceptor.py\", line 277, in __call__\n    response, ignored_call = self._with_call(\n                             ~~~~~~~~~~~~~~~^\n        request,\n        ^^^^^^^^\n    ...<4 lines>...\n        compression=compression,\n        ^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_interceptor.py\", line 332, in _with_call\n    return call.result(), call\n           ~~~~~~~~~~~^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_channel.py\", line 440, in result\n    raise self\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_interceptor.py\", line 315, in continuation\n    response, call = self._thunk(new_method).with_call(\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        request,\n        ^^^^^^^^\n    ...<4 lines>...\n        compression=new_compression,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_channel.py\", line 1198, in with_call\n    return _end_unary_response_blocking(state, call, True, None)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_channel.py\", line 1006, in _end_unary_response_blocking\n    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\ngrpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:\n\tstatus = StatusCode.UNAVAILABLE\n\tdetails = \"failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_status:14, grpc_message:\"failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\"}\"\n>\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.ServiceUnavailable: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 229, in _retry_error_helper\n    raise final_exc from source_exc\ngoogle.api_core.exceptions.RetryError: Timeout of 60.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: Timeout of 60.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\n\n", "record": {"elapsed": {"repr": "0:02:37.511648", "seconds": 157.511648}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: Error embedding content: Timeout of 60.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 76, in error_remapped_callable\n    return callable_(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_interceptor.py\", line 277, in __call__\n    response, ignored_call = self._with_call(\n                             ~~~~~~~~~~~~~~~^\n        request,\n        ^^^^^^^^\n    ...<4 lines>...\n        compression=compression,\n        ^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_interceptor.py\", line 332, in _with_call\n    return call.result(), call\n           ~~~~~~~~~~~^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_channel.py\", line 440, in result\n    raise self\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_interceptor.py\", line 315, in continuation\n    response, call = self._thunk(new_method).with_call(\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        request,\n        ^^^^^^^^\n    ...<4 lines>...\n        compression=new_compression,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_channel.py\", line 1198, in with_call\n    return _end_unary_response_blocking(state, call, True, None)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\grpc\\_channel.py\", line 1006, in _end_unary_response_blocking\n    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\ngrpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:\n\tstatus = StatusCode.UNAVAILABLE\n\tdetails = \"failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_status:14, grpc_message:\"failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\"}\"\n>\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 147, in retry_target\n    result = target()\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\timeout.py\", line 130, in func_with_timeout\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\grpc_helpers.py\", line 78, in error_remapped_callable\n    raise exceptions.from_grpc_error(exc) from exc\ngoogle.api_core.exceptions.ServiceUnavailable: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 227, in embed_documents\n    result = self.client.batch_embed_contents(\n        BatchEmbedContentsRequest(requests=requests, model=self.model)\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\ai\\generativelanguage_v1beta\\services\\generative_service\\client.py\", line 1392, in batch_embed_contents\n    response = rpc(\n        request,\n    ...<2 lines>...\n        metadata=metadata,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\gapic_v1\\method.py\", line 131, in __call__\n    return wrapped_func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 294, in retry_wrapped_func\n    return retry_target(\n        target,\n    ...<3 lines>...\n        on_error=on_error,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_unary.py\", line 156, in retry_target\n    next_sleep = _retry_error_helper(\n        exc,\n    ...<6 lines>...\n        timeout,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\google\\api_core\\retry\\retry_base.py\", line 229, in _retry_error_helper\n    raise final_exc from source_exc\ngoogle.api_core.exceptions.RetryError: Timeout of 60.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 91, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 163, in synthesize_answer\n    response = await query_engine.aquery(query)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_query_engine.py\", line 56, in aquery\n    query_result = await self._aquery(str_or_query_bundle)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 208, in _aquery\n    nodes = await self.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\query_engine\\retriever_query_engine.py\", line 150, in aretrieve\n    nodes = await self._retriever.aretrieve(query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index_instrumentation\\dispatcher.py\", line 368, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\base\\base_retriever.py\", line 241, in aretrieve\n    nodes = await self._aretrieve(query_bundle=query_bundle)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 89, in _aretrieve\n    query_embedding = await self._embedding_model.aembed_query(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        query_bundle.query_str\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\embeddings\\embeddings.py\", line 78, in aembed_query\n    return await run_in_executor(None, self.embed_query, text)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 617, in run_in_executor\n    return await asyncio.get_running_loop().run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<2 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_core\\runnables\\config.py\", line 608, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 256, in embed_query\n    return self.embed_documents(\n           ~~~~~~~~~~~~~~~~~~~~^\n        [text],\n        ^^^^^^^\n    ...<2 lines>...\n        output_dimensionality=output_dimensionality,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )[0]\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\langchain_google_genai\\embeddings.py\", line 231, in embed_documents\n    raise GoogleGenerativeAIError(f\"Error embedding content: {e}\") from e\nlangchain_google_genai._common.GoogleGenerativeAIError: Error embedding content: Timeout of 60.0s exceeded, last exception: 503 failed to connect to all addresses; last error: UNKNOWN: ipv4:216.58.206.42:443: tcp handshaker shutdown\n", "module": "main", "name": "src.main", "process": {"id": 52720, "name": "SpawnProcess-2"}, "thread": {"id": 50204, "name": "MainThread"}, "time": {"repr": "2025-09-03 03:59:53.458827+02:00", "timestamp": 1756864793.458827}}}
{"text": "2025-09-03 04:07:02.961 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:57.578771", "seconds": 57.578771}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 57280, "name": "MainProcess"}, "thread": {"id": 57296, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:07:02.961580+02:00", "timestamp": 1756865222.96158}}}
{"text": "2025-09-03 04:09:31.275 | INFO     | src.tasks:enrichment_task:15 - Starting enrichment for ad ID: 2cc4d816-9c7a-45d6-94a8-6c0f25562631\n", "record": {"elapsed": {"repr": "0:00:07.769780", "seconds": 7.76978}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 15, "message": "Starting enrichment for ad ID: 2cc4d816-9c7a-45d6-94a8-6c0f25562631", "module": "tasks", "name": "src.tasks", "process": {"id": 55580, "name": "MainProcess"}, "thread": {"id": 46420, "name": "AnyIO worker thread"}, "time": {"repr": "2025-09-03 04:09:31.275548+02:00", "timestamp": 1756865371.275548}}}
{"text": "2025-09-03 04:09:31.276 | ERROR    | src.tasks:enrichment_task:57 - Enrichment task failed for ad 2cc4d816-9c7a-45d6-94a8-6c0f25562631: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'\n", "record": {"elapsed": {"repr": "0:00:07.770389", "seconds": 7.770389}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 57, "message": "Enrichment task failed for ad 2cc4d816-9c7a-45d6-94a8-6c0f25562631: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'", "module": "tasks", "name": "src.tasks", "process": {"id": 55580, "name": "MainProcess"}, "thread": {"id": 46420, "name": "AnyIO worker thread"}, "time": {"repr": "2025-09-03 04:09:31.276157+02:00", "timestamp": 1756865371.276157}}}
{"text": "2025-09-03 04:10:17.491 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:53.985559", "seconds": 53.985559}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 55580, "name": "MainProcess"}, "thread": {"id": 53512, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:10:17.491327+02:00", "timestamp": 1756865417.491327}}}
{"text": "2025-09-03 04:10:17.540 | INFO     | src.tasks:enrichment_task:15 - Starting enrichment for ad ID: 8f02f9da-e9a1-422b-aa6b-139ada93faa4\n", "record": {"elapsed": {"repr": "0:00:54.034697", "seconds": 54.034697}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 15, "message": "Starting enrichment for ad ID: 8f02f9da-e9a1-422b-aa6b-139ada93faa4", "module": "tasks", "name": "src.tasks", "process": {"id": 55580, "name": "MainProcess"}, "thread": {"id": 46420, "name": "AnyIO worker thread"}, "time": {"repr": "2025-09-03 04:10:17.540465+02:00", "timestamp": 1756865417.540465}}}
{"text": "2025-09-03 04:10:17.540 | ERROR    | src.tasks:enrichment_task:57 - Enrichment task failed for ad 8f02f9da-e9a1-422b-aa6b-139ada93faa4: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'\n", "record": {"elapsed": {"repr": "0:00:54.035012", "seconds": 54.035012}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 57, "message": "Enrichment task failed for ad 8f02f9da-e9a1-422b-aa6b-139ada93faa4: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'", "module": "tasks", "name": "src.tasks", "process": {"id": 55580, "name": "MainProcess"}, "thread": {"id": 46420, "name": "AnyIO worker thread"}, "time": {"repr": "2025-09-03 04:10:17.540780+02:00", "timestamp": 1756865417.54078}}}
{"text": "2025-09-03 04:12:06.342 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: 4b0723fa-80dd-47ad-92fd-f9ff6aec93f2\n", "record": {"elapsed": {"repr": "0:00:17.852697", "seconds": 17.852697}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: 4b0723fa-80dd-47ad-92fd-f9ff6aec93f2", "module": "tasks", "name": "src.tasks", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:12:06.342469+02:00", "timestamp": 1756865526.342469}}}
{"text": "2025-09-03 04:12:06.343 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad 4b0723fa-80dd-47ad-92fd-f9ff6aec93f2: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'\n", "record": {"elapsed": {"repr": "0:00:17.853457", "seconds": 17.853457}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad 4b0723fa-80dd-47ad-92fd-f9ff6aec93f2: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'", "module": "tasks", "name": "src.tasks", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:12:06.343229+02:00", "timestamp": 1756865526.343229}}}
{"text": "2025-09-03 04:12:52.617 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:04.127313", "seconds": 64.127313}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:12:52.617085+02:00", "timestamp": 1756865572.617085}}}
{"text": "2025-09-03 04:12:52.678 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: ba609536-9873-4863-92f4-498a156d5524\n", "record": {"elapsed": {"repr": "0:01:04.188496", "seconds": 64.188496}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: ba609536-9873-4863-92f4-498a156d5524", "module": "tasks", "name": "src.tasks", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:12:52.678268+02:00", "timestamp": 1756865572.678268}}}
{"text": "2025-09-03 04:12:52.678 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad ba609536-9873-4863-92f4-498a156d5524: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'\n", "record": {"elapsed": {"repr": "0:01:04.189088", "seconds": 64.189088}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad ba609536-9873-4863-92f4-498a156d5524: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'", "module": "tasks", "name": "src.tasks", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:12:52.678860+02:00", "timestamp": 1756865572.67886}}}
{"text": "2025-09-03 04:13:38.468 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:01:49.978827", "seconds": 109.978827}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:13:38.468599+02:00", "timestamp": 1756865618.468599}}}
{"text": "2025-09-03 04:13:38.532 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: 086a83ff-fab3-4737-a51f-9b305646061d\n", "record": {"elapsed": {"repr": "0:01:50.042474", "seconds": 110.042474}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: 086a83ff-fab3-4737-a51f-9b305646061d", "module": "tasks", "name": "src.tasks", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:13:38.532246+02:00", "timestamp": 1756865618.532246}}}
{"text": "2025-09-03 04:13:38.532 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad 086a83ff-fab3-4737-a51f-9b305646061d: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'\n", "record": {"elapsed": {"repr": "0:01:50.043023", "seconds": 110.043023}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad 086a83ff-fab3-4737-a51f-9b305646061d: 'Depends' object has no attribute 'GEMINI_FLASH_MODEL'", "module": "tasks", "name": "src.tasks", "process": {"id": 43428, "name": "MainProcess"}, "thread": {"id": 58920, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:13:38.532795+02:00", "timestamp": 1756865618.532795}}}
{"text": "2025-09-03 04:15:22.362 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: 5573e7cd-1bef-4c30-885b-e6c9a497f43c\n", "record": {"elapsed": {"repr": "0:00:11.237484", "seconds": 11.237484}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: 5573e7cd-1bef-4c30-885b-e6c9a497f43c", "module": "tasks", "name": "src.tasks", "process": {"id": 58028, "name": "MainProcess"}, "thread": {"id": 54168, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:15:22.362540+02:00", "timestamp": 1756865722.36254}}}
{"text": "2025-09-03 04:15:22.484 | ERROR    | src.enrichment_pipeline:enrich_ad:154 - Enrichment failed for ad 1403518777546500: Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'llama_index.llms.langchain.base.LangChainLLM'>\n", "record": {"elapsed": {"repr": "0:00:11.358946", "seconds": 11.358946}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 154, "message": "Enrichment failed for ad 1403518777546500: Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'llama_index.llms.langchain.base.LangChainLLM'>", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 58028, "name": "MainProcess"}, "thread": {"id": 54168, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:15:22.484002+02:00", "timestamp": 1756865722.484002}}}
{"text": "2025-09-03 04:15:22.484 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad 5573e7cd-1bef-4c30-885b-e6c9a497f43c: Object of type UUID is not JSON serializable\n", "record": {"elapsed": {"repr": "0:00:11.359922", "seconds": 11.359922}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad 5573e7cd-1bef-4c30-885b-e6c9a497f43c: Object of type UUID is not JSON serializable", "module": "tasks", "name": "src.tasks", "process": {"id": 58028, "name": "MainProcess"}, "thread": {"id": 54168, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:15:22.484978+02:00", "timestamp": 1756865722.484978}}}
{"text": "2025-09-03 04:16:08.655 | ERROR    | src.query_engine:_aretrieve:104 - Failed to retrieve ads from Supabase: data=[] count=None\n", "record": {"elapsed": {"repr": "0:00:57.530921", "seconds": 57.530921}, "exception": null, "extra": {}, "file": {"name": "query_engine.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py"}, "function": "_aretrieve", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 104, "message": "Failed to retrieve ads from Supabase: data=[] count=None", "module": "query_engine", "name": "src.query_engine", "process": {"id": 58028, "name": "MainProcess"}, "thread": {"id": 54168, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:16:08.655977+02:00", "timestamp": 1756865768.655977}}}
{"text": "2025-09-03 04:16:08.714 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: 1d1e04ee-22a5-4b71-ad25-bf435cee2cf5\n", "record": {"elapsed": {"repr": "0:00:57.588977", "seconds": 57.588977}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: 1d1e04ee-22a5-4b71-ad25-bf435cee2cf5", "module": "tasks", "name": "src.tasks", "process": {"id": 58028, "name": "MainProcess"}, "thread": {"id": 54168, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:16:08.714033+02:00", "timestamp": 1756865768.714033}}}
{"text": "2025-09-03 04:16:08.802 | ERROR    | src.enrichment_pipeline:enrich_ad:154 - Enrichment failed for ad 1297420401724984: Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'llama_index.llms.langchain.base.LangChainLLM'>\n", "record": {"elapsed": {"repr": "0:00:57.677243", "seconds": 57.677243}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 154, "message": "Enrichment failed for ad 1297420401724984: Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'llama_index.llms.langchain.base.LangChainLLM'>", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 58028, "name": "MainProcess"}, "thread": {"id": 54168, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:16:08.802299+02:00", "timestamp": 1756865768.802299}}}
{"text": "2025-09-03 04:16:08.803 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad 1d1e04ee-22a5-4b71-ad25-bf435cee2cf5: Object of type UUID is not JSON serializable\n", "record": {"elapsed": {"repr": "0:00:57.678142", "seconds": 57.678142}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad 1d1e04ee-22a5-4b71-ad25-bf435cee2cf5: Object of type UUID is not JSON serializable", "module": "tasks", "name": "src.tasks", "process": {"id": 58028, "name": "MainProcess"}, "thread": {"id": 54168, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:16:08.803198+02:00", "timestamp": 1756865768.803198}}}
{"text": "2025-09-03 04:17:23.975 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: fd07e42b-299c-425a-9123-244192a5c448\n", "record": {"elapsed": {"repr": "0:00:12.644535", "seconds": 12.644535}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: fd07e42b-299c-425a-9123-244192a5c448", "module": "tasks", "name": "src.tasks", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:17:23.975066+02:00", "timestamp": 1756865843.975066}}}
{"text": "2025-09-03 04:17:26.855 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad fd07e42b-299c-425a-9123-244192a5c448: Object of type UUID is not JSON serializable\n", "record": {"elapsed": {"repr": "0:00:15.524624", "seconds": 15.524624}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad fd07e42b-299c-425a-9123-244192a5c448: Object of type UUID is not JSON serializable", "module": "tasks", "name": "src.tasks", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:17:26.855155+02:00", "timestamp": 1756865846.855155}}}
{"text": "2025-09-03 04:18:09.356 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 92, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n\n", "record": {"elapsed": {"repr": "0:00:58.025866", "seconds": 58.025866}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 92, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n", "module": "main", "name": "src.main", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:18:09.356397+02:00", "timestamp": 1756865889.356397}}}
{"text": "2025-09-03 04:18:09.406 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: 1d16092d-b0ca-4398-b41b-0754f1474aa7\n", "record": {"elapsed": {"repr": "0:00:58.076102", "seconds": 58.076102}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: 1d16092d-b0ca-4398-b41b-0754f1474aa7", "module": "tasks", "name": "src.tasks", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:18:09.406633+02:00", "timestamp": 1756865889.406633}}}
{"text": "2025-09-03 04:18:13.319 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad 1d16092d-b0ca-4398-b41b-0754f1474aa7: Object of type UUID is not JSON serializable\n", "record": {"elapsed": {"repr": "0:01:01.988745", "seconds": 61.988745}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad 1d16092d-b0ca-4398-b41b-0754f1474aa7: Object of type UUID is not JSON serializable", "module": "tasks", "name": "src.tasks", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:18:13.319276+02:00", "timestamp": 1756865893.319276}}}
{"text": "2025-09-03 04:18:54.798 | ERROR    | src.main:global_exception_handler:30 - Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 92, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n\n", "record": {"elapsed": {"repr": "0:01:43.467543", "seconds": 103.467543}, "exception": null, "extra": {}, "file": {"name": "main.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py"}, "function": "global_exception_handler", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 30, "message": "Unhandled exception: 'NoneType' object has no attribute 'context_window'\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 148, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 27, in global_exception_handler\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 156, in call_next\n    raise app_exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 141, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\main.py\", line 92, in query_ad_intelligence\n    answer = await synthesize_answer(\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\query_engine.py\", line 151, in synthesize_answer\n    response_synthesizer = get_response_synthesizer(\n        llm=gemini_pro,\n        text_qa_template=query_synthesis_prompt,\n        refine_template=critique_prompt,\n    )\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\response_synthesizers\\factory.py\", line 62, in get_response_synthesizer\n    or PromptHelper.from_llm_metadata(\n       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        llm.metadata,\n        ^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\maxim\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\llama_index\\core\\indices\\prompt_helper.py\", line 123, in from_llm_metadata\n    context_window = llm_metadata.context_window\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'context_window'\n", "module": "main", "name": "src.main", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:18:54.798074+02:00", "timestamp": 1756865934.798074}}}
{"text": "2025-09-03 04:18:54.854 | INFO     | src.tasks:enrichment_task:12 - Starting enrichment for ad ID: 41c94bdf-7142-45da-9a5a-bda46763bdbb\n", "record": {"elapsed": {"repr": "0:01:43.524049", "seconds": 103.524049}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "ℹ️", "name": "INFO", "no": 20}, "line": 12, "message": "Starting enrichment for ad ID: 41c94bdf-7142-45da-9a5a-bda46763bdbb", "module": "tasks", "name": "src.tasks", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:18:54.854580+02:00", "timestamp": 1756865934.85458}}}
{"text": "2025-09-03 04:18:57.922 | ERROR    | src.tasks:enrichment_task:53 - Enrichment task failed for ad 41c94bdf-7142-45da-9a5a-bda46763bdbb: Object of type UUID is not JSON serializable\n", "record": {"elapsed": {"repr": "0:01:46.591977", "seconds": 106.591977}, "exception": null, "extra": {}, "file": {"name": "tasks.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\tasks.py"}, "function": "enrichment_task", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 53, "message": "Enrichment task failed for ad 41c94bdf-7142-45da-9a5a-bda46763bdbb: Object of type UUID is not JSON serializable", "module": "tasks", "name": "src.tasks", "process": {"id": 55792, "name": "MainProcess"}, "thread": {"id": 53696, "name": "MainThread"}, "time": {"repr": "2025-09-03 04:18:57.922508+02:00", "timestamp": 1756865937.922508}}}
{"text": "2025-09-04 14:17:19.460 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:03.213042", "seconds": 3.213042}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 109560, "name": "MainProcess"}, "thread": {"id": 108780, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:17:19.460682+02:00", "timestamp": 1756988239.460682}}}
{"text": "2025-09-04 14:17:19.463 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:03.216145", "seconds": 3.216145}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 109560, "name": "MainProcess"}, "thread": {"id": 108780, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:17:19.463785+02:00", "timestamp": 1756988239.463785}}}
{"text": "2025-09-04 14:17:19.467 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:03.219623", "seconds": 3.219623}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 109560, "name": "MainProcess"}, "thread": {"id": 108780, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:17:19.467263+02:00", "timestamp": 1756988239.467263}}}
{"text": "2025-09-04 14:18:28.451 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.031779", "seconds": 2.031779}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 98476, "name": "MainProcess"}, "thread": {"id": 109172, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:18:28.451220+02:00", "timestamp": 1756988308.45122}}}
{"text": "2025-09-04 14:18:28.455 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.036007", "seconds": 2.036007}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 98476, "name": "MainProcess"}, "thread": {"id": 109172, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:18:28.455448+02:00", "timestamp": 1756988308.455448}}}
{"text": "2025-09-04 14:18:28.458 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:02.039083", "seconds": 2.039083}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 98476, "name": "MainProcess"}, "thread": {"id": 109172, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:18:28.458524+02:00", "timestamp": 1756988308.458524}}}
{"text": "2025-09-04 14:18:56.394 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.082866", "seconds": 2.082866}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 108992, "name": "MainProcess"}, "thread": {"id": 109068, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:18:56.394399+02:00", "timestamp": 1756988336.394399}}}
{"text": "2025-09-04 14:18:56.398 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.087187", "seconds": 2.087187}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 108992, "name": "MainProcess"}, "thread": {"id": 109068, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:18:56.398720+02:00", "timestamp": 1756988336.39872}}}
{"text": "2025-09-04 14:18:56.401 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:02.089637", "seconds": 2.089637}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 108992, "name": "MainProcess"}, "thread": {"id": 109068, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:18:56.401170+02:00", "timestamp": 1756988336.40117}}}
{"text": "2025-09-04 14:20:29.083 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.072588", "seconds": 2.072588}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 108744, "name": "MainProcess"}, "thread": {"id": 107936, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:20:29.083906+02:00", "timestamp": 1756988429.083906}}}
{"text": "2025-09-04 14:20:29.087 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.076430", "seconds": 2.07643}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 108744, "name": "MainProcess"}, "thread": {"id": 107936, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:20:29.087748+02:00", "timestamp": 1756988429.087748}}}
{"text": "2025-09-04 14:20:29.090 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:02.079067", "seconds": 2.079067}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 108744, "name": "MainProcess"}, "thread": {"id": 107936, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:20:29.090385+02:00", "timestamp": 1756988429.090385}}}
{"text": "2025-09-04 14:21:00.556 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.035620", "seconds": 2.03562}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 62812, "name": "MainProcess"}, "thread": {"id": 104992, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:21:00.556230+02:00", "timestamp": 1756988460.55623}}}
{"text": "2025-09-04 14:21:00.560 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.039673", "seconds": 2.039673}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 62812, "name": "MainProcess"}, "thread": {"id": 104992, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:21:00.560283+02:00", "timestamp": 1756988460.560283}}}
{"text": "2025-09-04 14:21:00.562 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:02.042298", "seconds": 2.042298}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 62812, "name": "MainProcess"}, "thread": {"id": 104992, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:21:00.562908+02:00", "timestamp": 1756988460.562908}}}
{"text": "2025-09-04 14:25:11.586 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:01.997519", "seconds": 1.997519}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 109044, "name": "MainProcess"}, "thread": {"id": 110476, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:25:11.586546+02:00", "timestamp": 1756988711.586546}}}
{"text": "2025-09-04 14:25:11.590 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.001473", "seconds": 2.001473}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 109044, "name": "MainProcess"}, "thread": {"id": 110476, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:25:11.590500+02:00", "timestamp": 1756988711.5905}}}
{"text": "2025-09-04 14:25:11.593 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:02.004712", "seconds": 2.004712}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 109044, "name": "MainProcess"}, "thread": {"id": 110476, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:25:11.593739+02:00", "timestamp": 1756988711.593739}}}
{"text": "2025-09-04 14:26:49.195 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.014489", "seconds": 2.014489}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 99436, "name": "MainProcess"}, "thread": {"id": 109944, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:26:49.195526+02:00", "timestamp": 1756988809.195526}}}
{"text": "2025-09-04 14:26:49.202 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:02.021488", "seconds": 2.021488}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 99436, "name": "MainProcess"}, "thread": {"id": 109944, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:26:49.202525+02:00", "timestamp": 1756988809.202525}}}
{"text": "2025-09-04 14:26:49.207 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:02.026048", "seconds": 2.026048}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 99436, "name": "MainProcess"}, "thread": {"id": 109944, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:26:49.207085+02:00", "timestamp": 1756988809.207085}}}
{"text": "2025-09-04 14:27:43.797 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Visual analysis failed\n", "record": {"elapsed": {"repr": "0:00:01.613365", "seconds": 1.613365}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Visual analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 110476, "name": "MainProcess"}, "thread": {"id": 107660, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:27:43.797612+02:00", "timestamp": 1756988863.797612}}}
{"text": "2025-09-04 14:27:43.801 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Strategic analysis failed\n", "record": {"elapsed": {"repr": "0:00:01.617161", "seconds": 1.617161}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Strategic analysis failed", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 110476, "name": "MainProcess"}, "thread": {"id": 107660, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:27:43.801408+02:00", "timestamp": 1756988863.801408}}}
{"text": "2025-09-04 14:27:43.805 | ERROR    | src.enrichment_pipeline:enrich_ad:158 - Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.\n", "record": {"elapsed": {"repr": "0:00:01.621093", "seconds": 1.621093}, "exception": null, "extra": {}, "file": {"name": "enrichment_pipeline.py", "path": "C:\\Users\\maxim\\Desktop\\deepwiki+context7\\src\\enrichment_pipeline.py"}, "function": "enrich_ad", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 158, "message": "Enrichment failed for ad 123: Ad creative URL not found in raw_data_snapshot.", "module": "enrichment_pipeline", "name": "src.enrichment_pipeline", "process": {"id": 110476, "name": "MainProcess"}, "thread": {"id": 107660, "name": "MainThread"}, "time": {"repr": "2025-09-04 14:27:43.805340+02:00", "timestamp": 1756988863.80534}}}
